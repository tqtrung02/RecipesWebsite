<% if(recipe != null ) { %>

    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Trang chủ</a></li>
        <li class="breadcrumb-item"><a href="/categories/<%- recipe.category %>"><%- recipe.category %></a></li>
        <li class="breadcrumb-item active" aria-current="page"><%- recipe.name %></li>
      </ol>
    </nav>
  
  
    <div class="row">
  
      <div class="col-12 col-md-4">
        <img src="/uploads/<%- recipe.image %>" class="img-fluid sticky-top" style="top: 20px;" alt="<%- recipe.name %>" loading="lazy">
      </div>
  
      <div class="col-12 col-md-8">
        <div class="row">
          <div class="col-12"><h1><%- recipe.name %></h1>
            <% if (user) { %>
              <div class="position-relative">
                <% if (user.favorites.includes(recipe._id.toString())) { %>
                  <!-- Button to remove from favorites (Top-right corner) -->
                  <a href="/recipe/unfavorite/<%= recipe._id %>" class="btn btn-outline-danger btn-lg position-absolute top-0 end-0 m-3" title="Remove from Favorites">
                    <i class="bi bi-heart-fill fs-5"></i> Remove
                  </a>
                <% } else { %>
                  <!-- Button to add to favorites (Top-right corner) -->
                  <a href="/recipe/favorite/<%= recipe._id %>" class="btn btn-outline-danger btn-lg position-absolute top-0 end-0 m-3" title="Add to Favorites">
                    <i class="bi bi-heart fs-5"></i> Add
                  </a>
                <% } %>
              </div>
            <% } %>
          </div>
          <div class="col-12 mb-4"><i class="bi bi-tag"></i> <%- recipe.category %></div>
          <div class="col-12" style="white-space: pre-line;">
            <h4>Công thức</h4>
            <%- recipe.description %>
          </div>
        </div>
  
        <div class="row pt-4">
          <div class="col-12">
            <h4>Nguyên liệu</h4>
            <ul class="list-group list-group-flush">
              <% recipe.ingredients.forEach(function(ingredients, index){ %>
                <li class="list-group-item"><%= ingredients %></li>
              <% }) %>
            </ul> 
          </div>
        </div>
      </div>
    </div>
    <% if (user && (recipe.email === user.email || user.role === 'admin')) { %> <!-- Check if the logged-in user is the owner or admin-->
      <div class="mt-4 d-flex justify-content-end gap-2 me-3">
        <a href="/recipe/edit/<%= recipe._id %>" class="btn btn-outline-warning btn-lg d-flex align-items-center gap-2">
          <i class="bi bi-pencil-square fs-5"></i>
          <span>Sửa công thức</span>
        </a>
        <a href="/recipe/delete/<%= recipe._id %>" class="btn btn-outline-danger btn-lg d-flex align-items-center gap-2"
           onclick="return confirm('Bạn có muốn xóa công thức không ?')">
          <i class="bi bi-trash fs-5"></i>
          <span>Xóa công thức</span>
        </a>
      </div>      
  <% } %>
  <% } else { %>
    <p>No item found.</p>
  <% } %>